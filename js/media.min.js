// CyborgDesigner v20260108
// (c) 2025 Cyborg Unicorn Pty Ltd.
// This software is released under MIT License.

/*jsl:ignore*/

function media(b,e){function q(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c=16*Math.random()|0;return("x"===a?c:c&3|8).toString(16)})}var f=e.containerID,m=null,g="";(function(){b.element("#"+f,e.loginLink).on("click",function(a){a.preventDefault();a=b.element("#"+f,e.loginBox);0<a.length&&(a.show(),a=b.element("#"+f,e.adminField),0<a.length&&a.focus())})})();(function(){var a,c;g="gallery-"+q();var n=b.element("#"+f,e.gallery);n.attr("id",g);m=new listRenderer(b,
g,{dataSource:"local",type:"GALLERY",flow:"EXPAND",target:"",thumbsize:{X:150,Y:150},imagefield:"IMAGEURL",initialData:e.mediaData,cbLoadData:function(p,c){var d={};for(a=0;a<p.parameters.length;a++){var b=p.parameters[a];d[b.name]=b.value}var d=d.search?d.search.toLowerCase():"",b=e.mediaData,f=JSON.parse(JSON.stringify(b.data)),h=f;if(0<d.length){h=[];for(a=0;a<f.length;a++){var l=f[a];-1!==(l[1]+"\n"+l[3].toUpperCase()+" ("+l[4]+" KB)").toLowerCase().indexOf(d)&&h.push(l)}}c({control:{offset:0,
limit:h.length,total:h.length,more:!1},operations:b.operations,fields:b.fields,data:h})},cbGetDescription:function(b){return b[1]+"\n"+b[3].toUpperCase()+" ("+b[4]+" KB)"},cbOnClick:function(a,e){c=b.getWindow();c.console&&c.console.log&&c.console.log("Click: "+e)},cbOnDblClick:function(a,f){c=b.getWindow();c.open(e.mediaDir+a[1],"_blank")},cbOnOperation:function(a,k,d){if("delete"===a)c=b.getWindow(),c.confirm("Delete file: "+k[1]+"?")&&(a=b.createElement("form"),a.method="POST",a.action="media.php",
a.className="ge-media-delete-form",d=b.createElement("input"),d.type="hidden",d.name="delete_file",d.value="1",a.appendChild(d),d=b.createElement("input"),d.type="hidden",d.name="filename",d.value=k[1],a.appendChild(d),b.element("#"+f).append(a),a.submit());else if("copy_url"===a){c=b.getWindow();var g=c.location.origin+"/"+e.mediaDir+k[1];c.navigator&&c.navigator.clipboard&&c.navigator.clipboard.writeText(g).then(function(){c.alert("URL copied to clipboard:\n"+g)})}else"view"===a&&(c=b.getWindow(),
c.open(e.mediaDir+k[1],"_blank"))}});n.html(m.render())})()};
